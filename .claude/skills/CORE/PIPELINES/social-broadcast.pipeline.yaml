# ============================================================================
# PIPELINE: social-broadcast
# ============================================================================
#
# Adapt content and broadcast to multiple social platforms.
#
# USAGE:
#   pai pipeline social-broadcast --content "Big announcement..." --platforms x,linkedin
#
# This pipeline adapts content for each platform then posts (with dry-run by default).
#
# ============================================================================

name: social-broadcast
version: "1.0.0"
description: Adapt and broadcast content to social media platforms

# Pipeline input schema
input:
  content:
    type: string
    required: true
    description: The content to broadcast
  platforms:
    type: array
    default: [x, linkedin, bluesky]
    description: Target platforms
  dryRun:
    type: boolean
    default: true
    description: Preview without posting

# Pipeline output schema
output:
  adapted:
    type: object
    description: Adapted content per platform
  results:
    type: array
    description: Post results per platform

# Step definitions
steps:
  # Step 1: Adapt content for each platform
  - id: adapt
    action: social/adapt
    input:
      content: "{{input.content}}"
      platforms: "{{input.platforms}}"

  # Step 2: Post to platforms
  # Note: In a real implementation, this would iterate over platforms
  # For now, we post the original (adapter handles internally)
  - id: post
    action: social/post
    input:
      content: "{{input.content}}"
      platforms: "{{input.platforms}}"
      dryRun: "{{input.dryRun}}"

# Final output mapping
output_mapping:
  adapted: "{{steps.adapt.output.adapted}}"
  results: "{{steps.post.output.results}}"
  truncated: "{{steps.adapt.output.truncated}}"
