# Additional converted Fish functions (Batch 8)

# shortlog - Alias for shortlog
function shortlog() {
    git shortlog
}

# cargo_target - Spins up a RAM disk for Cargo target output
function cargo_target() {
    local quiet="$1"
    local drive_name="CargoTarget"
    local default_size=50
    local target_path="/Volumes/$drive_name"
    local icon_file="~/Pictures/Icons/rustacean-flat-happy.webp"
    
    local output
    if [[ -d "$target_path" ]]; then
        echo "$drive_name already mounted"
        output=$(diskutil list "$drive_name")
    else
        output=$(ramdisk "$default_size" "$drive_name")
        fileicon set "/Volumes/$drive_name" "$icon_file"
    fi
    
    export CARGO_TARGET_DIR="$target_path"
    
    if [[ -z "$quiet" ]]; then
        echo "$output"
    fi
}

# octodec - SSH to octodec
function octodec() {
    ssh phatblat@octodec.local "$@"
}

# itwire - Quick dir navigation to ITWire
function itwire() {
    pushd ~/dev/bluemix/ITWire
}

# moj_user - Prints an emoji for the current user
function moj_user() {
    case "$USER" in
        admin)
            echo "ğŸ™†ğŸ»â€â™‚ï¸" ;;
        ben|f*)
            echo "ğŸš¶" ;;
        benchatelain|chatelain|zoltar)
            echo "ğŸ‘¨ğŸ»â€ğŸš€" ;;
        phatblat)
            echo "ğŸ§" ;;
        jenkins)
            echo "ğŸ‘·ğŸ»â€â™‚ï¸" ;;
        *)
            echo "${USER:0:1}â“" ;;
    esac
}

# ignores - Standard ignored files
function ignores() {
    cat <<EOF
# macOS
.DS_Store
# Xcode
*.xccheckout
*.xcscmblueprint
xcuserdata
Carthage/
Pods/
# Swift PM
.build/
.swiftpm/
# Bundler
.rubygems/
bin/
# Gradle
build/
.gradle/
gradlew.bat
# IntelliJ IDEA
.idea/
*.iml
*.hprof
# VS Code
.classpath
.project
.settings
.vscode/
# Rust
.target/
# CMake
.cxx/
cmake-build-debug/
.externalNativeBuild/
# Java
heapdump.*.phd
javacore.*.txt
# Rust/Cargo
target/
# Visual Studio, MSBuild
*.dll
.vs/
obj/
packages/
# Visual Studio, MSBuild
.vscode/
# Bazel
bazel-*
# Buck2
buck-out/
# Python
__pycache__/
# Node.js
node_modules/
# npm
.npm/
EOF
}

# is_octodec - Tests whether the current computer is octodec
function is_octodec() {
    [[ "$(hostname)" == *"octodec"* ]]
}

# openports - Lists open ports for the current user
function openports() {
    lsof -i | grep LISTEN
}

# func_count - Prints a count of all functions
function func_count() {
    local all=$(functions | wc -l | xargs)
    local custom=$(find ~/.config/fish/functions -type f -maxdepth 1 -name '*.fish' | wc -l | xargs)
    local plugins=$(find ~/.config/fish/functions -type l -maxdepth 1 -name '*.fish' | wc -l | xargs)
    local autoloaded=$(ls -1 ~/.config/fish/functions/*.fish | wc -l | xargs)
    
    echo "Functions: $all ($custom custom, $plugins plugins, $autoloaded autoloaded)"
}

# r - Interactive rebase for the last few commits
function r() {
    local count=${1:-10}
    
    toggle_wait on
    
    git rebase --interactive HEAD~$count
    
    toggle_wait off
}
